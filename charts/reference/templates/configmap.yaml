apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
  namespace: anchor-platform
data:
  reference-config.yaml: |
    apiVersion: v1
kind: ConfigMap
metadata:
  name: anchor-platform-reference-server-config-preview-id
  namespace: common-previews
  annotations:
    fluxcd.io/ignore: "true"  # Manifests only used for PR previews
data:
  # TODO: remove all secrets (ex: move to env vars, k8s secrets, vault, etc...)
  reference-config.yaml: |
    server:
      servlet:
        context-path: /
        port: 8081
    #
    # The settings of the anchor reference serer
    #
    anchor.settings:
      version: 0.0.1
    event:
      kafkaBootstrapServer: anchor-platform-kafka:9092
      sep31Endpoint: anchor-sep-preview-id.previews.kube001.services.stellar-ops.com
      eventTypeToQueue:
        all: pr_preview-id_ap_event_single_queue
        quote_created: pr_preview-id_ap_event_quote_created
        transaction_created: pr_preview-id_ap_event_transaction_created
        transaction_payment_received: pr_preview-id_ap_event_transaction_payment_received
        transaction_error: pr_preview-id_ap_event_transaction_error
    #
    # Spring Data JDBC settings for H2
    #
    spring.datasource.url: jdbc:h2:mem:test
    spring.jpa.properties.hibernate.dialect: org.hibernate.dialect.H2Dialect
    # force gson as serializer/deserializer over jackson
    spring.mvc.converters.preferred-json-mapper: gson
    #
    # Spring Data JDBC settings for SQLite
    #
    #spring.jpa.database-platform=org.stellar.anchor.reference.sqlite.SQLiteDialect
    #spring.jpa.hibernate.ddl-auto=update
    #spring.jpa.generate-ddl=true
    #spring.datasource.url=jdbc:sqlite:anchor-reference-server.db
    #spring.datasource.driver-class-name=org.sqlite.JDBC
    #spring.datasource.username=admin
    #spring.datasource.password=admin
  stellar-wks.toml: |
    ACCOUNTS = ["GDZCLP2PHTWYQ3BWZMC5D4ZUJX5NU4S7YZHC5EBFAFKL6UJUQ5RKDGSY"]
    VERSION = "0.1.0"
    NETWORK_PASSPHRASE = "Test SDF Network ; September 2015"
    SIGNING_KEY = "GDZCLP2PHTWYQ3BWZMC5D4ZUJX5NU4S7YZHC5EBFAFKL6UJUQ5RKDGSY"
    TRANSFER_SERVER = "https://anchor-sep-preview-id.previews.kube001.services.stellar-ops.com/sep6"
    TRANSFER_SERVER_SEP0024 = "https://anchor-sep-preview-id.previews.kube001.services.stellar-ops.com/sep24"
    WEB_AUTH_ENDPOINT = "https://anchor-sep-preview-id.previews.kube001.services.stellar-ops.com/auth"
    KYC_SERVER = "https://anchor-sep-preview-id.previews.kube001.services.stellar-ops.com/sep12"
    DIRECT_PAYMENT_SERVER = "https://anchor-sep-preview-id.previews.kube001.services.stellar-ops.com/sep31"
    ANCHOR_QUOTE_SERVER = "https://anchor-sep-preview-id.previews.kube001.services.stellar-ops.com/sep38"
    [[CURRENCIES]]
    code = "USDC"
    issuer = "GBBD47IF6LWK7P7MDEVSCWR7DPUWV3NY3DTQEVFL4NAT4AQH3ZLLFLA5"
    status = "test"
    is_asset_anchored = true
    anchor_asset_type = "fiat"
    desc = "A test USDC issued by Circle."
    [DOCUMENTATION]
    ORG_NAME = "Stellar Development Foundation"
    ORG_URL = "https://www.stellar.org"
    ORG_DESCRIPTION = "Stellar is an open network for storing and moving money."
    ORG_LOGO="https://assets-global.website-files.com/5deac75ecad2173c2ccccbc7/5dec8960504967fd31147f62_Stellar_lockup_black_RGB.svg"
    ORG_SUPPORT_EMAIL="jamie@stellar.org"